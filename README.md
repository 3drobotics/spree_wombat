# Spree Wombat

Connect your SpreeCommerce Storefront to Wombat, providing push API and webhook handlers

## Installation

Add spree_wombat to your Gemfile:

```ruby
gem 'spree_wombat', github: 'spree/spree_wombat', branch: '2-2-stable'
```

Bundle your dependencies and run the installation generator:

```shell
bundle
bundle exec rails g spree_wombat:install
```

Add your Wombat credentials to `config/initializers/wombat.rb`:

```ruby
Spree::Wombat::Config.configure do |config|
  config.connection_token = "YOUR TOKEN"
  config.connection_id = "YOUR CONNECTION ID"
end
```

## Configuration

All the configuration is done inside the initializer here: `config/initializers/wombat.rb`

* push_url
* push_objects
* payload_builder
* last_pushed_timestamps

## Push to the hub

```shell
bundle exec rake wombat:push_it
```

## Create handler for a webhook

```shell
bundle exec rails g wombat:webhook my_webhook
```

this will generate a handler class for the `my_webhook` webhook in `lib/spree/wombat/handler/my_webhookhandler.rb`

```ruby
module Spree
  module Wombat
    module Handler
      class MyWebhookHandler < Base

        def process
          @webhook = @payload[:webhook]

          #insert code here to handle
        end

      end
    end
  end
end

```


## Create custom serializers

```shell
bundle exec rails g wombat:serializer
```


## Testing

First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app`.

```shell
bundle
bundle exec rake
```

Copyright (c) 2014 Spree Commerce, Inc. and other contributors, released under the New BSD License
